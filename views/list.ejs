<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <link href="/main.css" rel="stylesheet">
</head>
<body class="grey-bg">

  <%- include('nav.ejs') %>
  <!-- insert the nav bar -->

  <% for (var i = 0; i < posts.length; i++){ %>
    <!-- Create nth content box -->
    <div class="white-bg">
      <div class="list-box">
        
        <h4><a href="/detail/<%= posts[i]._id %>" style="text-decoration : none">
          <%= posts[i].title %>
          <!-- Create nth link using tag <a> -->
          <!-- text-decoration : none  : getting rid of underline -->
        </a>

        <a href="/edit/<%= posts[i]._id %>">
          üî®
        </a>
        <span class="delete" data-id="<%= posts[i]._id %>">üóëÔ∏è</span>
        </h4>
        <p><%= posts[i].content %></p>
      </div>
      
      
       
    </div> 
    <% } %> 
    <!-- ÌéòÏù¥ÏßÄÎÑ§Ïù¥ÏÖò -->
    <div class="container">
      <div class="pagination">
        <img src="/arrow.png"><button class="btn" onclick="backBtn()">prev</button>
          <ul>

            <!-- <% if ( posts.length < 26 ){ %> -->

                <% for (var i = 1; i < 6 ; i++){ %>
                <li class="link" value="<%= i %>" onclick="activelink()"><a href="/list/<%= i %>" style="text-decoration : none">
                <%= i %></a></li>
                <% } %>

            <!-- <% } else{ %>
                   
                  
                  <% for (var i = 6;  i < 11 ; i++){ %>
                    <li class="link" value="<%= i %>" onclick="activelink()"><a href="/list/<%= i %>" style="text-decoration : none">
                    <%= i %></a></li>
                  <% } %> -->

            <!-- <% } %> -->
                 

           
          </ul>
          <button class="btn" onclick="nextBtn()">next</button>
          <img src="/arrow.png" class="rotateImg"> 
      </div>
    </div>
    <script>
      
    for (let i = 0; i < '<%=posts.length %>'; i++){
      document.querySelectorAll('.delete')[i].addEventListener('click', function(e){
          fetch('/delete?docid='+e.target.dataset.id, {
          method : 'DELETE',
          headers : { 'Content-Type' : 'application/json' },
        })
        .then((r)=>r.text())
        .then((r)=>{e.target.parentElement.parentElement.style.display = 'none'  })
      })
    }

    // ÌéòÏù¥ÏßÄÎÑ§Ïù¥ÏÖò
    let link = document.getElementsByClassName("link");

      let currentValue = 1;

      function activelink(){
        for (l of link){
             l.classList.remove("active")
        }
        event.target.classList.add("active")
        currentValue=event.target.value;
      }
      
      function backBtn() {
        if (currentValue > 1) {
          for (l of link){
             l.classList.remove("active")
        }
        currentValue--;
        link[currentValue-1].classList.add("active")
        }
      }

      function nextBtn() {
        if (currentValue < 6) {
          for (l of link){
             l.classList.remove("active")
        }
        currentValue++;
        link[currentValue-1].classList.add("active")
        }
      }
       
      // ÌéòÏù¥ÏßÄÎÑ§Ïù¥ÏÖò (2)
      document.querySelectorAll('.link')[0].addEventListener('click', function(){
          console.log(posts.length)

      })

      

    </script>

  </body>
</html>
<!-- fetch() : function for using ajax -->
<!-- ÎäêÎÇåÌëúÏπòÍ≥† ÏóîÌÑ∞ÌÇ§ : html Í∏∞Î≥∏ÌÖúÌîåÎ¶ø -->

